```
import java.io.*;
import java.util.*;

public class Solution2 {
	static int N;
	static int M;
	static int [] dx = {-1,1,0,0};
	static int [] dy = {0,0,-1,1};
	static int [][] map;
	static boolean [] comb;
	static ArrayDeque <int []> virus; 

	public static void main(String[] args) throws Exception{
		BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
		StringTokenizer ss = new StringTokenizer(bf.readLine());
		
		virus = new ArrayDeque<>();
		N = Integer.parseInt(ss.nextToken());
		M = Integer.parseInt(ss.nextToken());
		map = new int [N][M];
		
		for(int i=0; i<N; i++) {
			StringTokenizer st = new StringTokenizer(bf.readLine());
			for(int j=0; j<M; j++) {
				map[i][j] = Integer.parseInt(st.nextToken());
				if(map[i][j]==2) {
					virus.add(new int [] {i,j});
				}
			}
		}
		int mx=0;
		for(int i=0; i<N*M-2; i++) {
			for(int j=i+1; j<N*M-1;j++) {
				for(int k=j+1;k<N*M;k++) {
					//System.out.println("i,j,k= "+i+","+ j+","+ k);
					int r = infection(i,j,k);
					mx=Math.max(mx, r);
					
				}
			}
		}
		System.out.println(mx);
	}
	
	//세로길이 N 가로길이 M (0,0)~((N-1),(M-1))이라면 (i, j)가 나타내는 숫자는 i*M+j
	// M M+1 ... 2M-1
	// 2N
	static int infection(int a, int b, int c) {
		int [][] con = new int [N][M];
		int count=0;
		for(int [] mm : map) {
			con[count] = mm.clone();
			count++;
		}
		ArrayDeque <int []> v = new ArrayDeque<>();
		for(int [] arr:virus) {
			v.add(arr.clone());
		}
		int ra = a/M;
		int ca = a%M;
		int rb = b/M;
		int cb = b%M;
		int rc = c/M;
		int cc = c%M;
		//System.out.println(ra+","+ ca+","+ rb+","+ cb+","+ rc+","+ cc);
		if(con[ra][ca]==0 && con[rb][cb]==0 && con[rc][cc]==0) {
			con[ra][ca]=1;
			con[rb][cb]=1;
			con[rc][cc]=1;
			
			while(!v.isEmpty()) {
				int [] temp = v.poll();
				int row = temp[0];
				int col = temp[1];
				
				for(int p=0; p<4; p++) {
					int newr = row+dx[p];
					int newc = col+dy[p];
					
					if(newr>=0 && newr<N && newc>=0 && newc<M) {
						if(con[newr][newc]==0) {
							con[newr][newc]=2;
							v.offer(new int [] {newr,newc});
						}
					}
				}
			}
			//System.out.println(Arrays.deepToString(con));
			int result =0;
			for(int i=0; i<N; i++) {
				for(int j=0; j<M; j++) {
					if(con[i][j]==0) {
						result++;
					}
				}
			}
			return result;
		}
		return 0;
	}
}
```
